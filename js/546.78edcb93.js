"use strict";(self["webpackChunkheimatoutiao"]=self["webpackChunkheimatoutiao"]||[]).push([[546],{5439:function(t,i,a){a.r(i),a.d(i,{default:function(){return _}});var e=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",[a("van-nav-bar",{attrs:{fixed:"",title:"文章详情","left-arrow":""},on:{"click-left":function(i){return t.$router.back()}}}),0===Object.keys(t.articleDetailList).length?a("van-loading",{staticClass:"loading",attrs:{color:"#1989fa"}},[t._v("加载中")]):a("div",[a("div",{staticClass:"article-container"},[a("h1",{staticClass:"art-title"},[t._v(t._s(t.articleDetailList.title))]),a("van-cell",{attrs:{center:"",title:t.articleDetailList.aut_name,label:t.articleDetailList.pubdate},scopedSlots:t._u([{key:"icon",fn:function(){return[a("img",{staticClass:"avatar",attrs:{src:t.articleDetailList.aut_photo,alt:""}})]},proxy:!0},{key:"default",fn:function(){return[a("div",[!0===t.articleDetailList.is_followed?a("van-button",{attrs:{type:"info",size:"mini"},on:{click:function(i){return t.attention(!0)}}},[t._v("已关注")]):a("van-button",{attrs:{icon:"plus",type:"info",size:"mini",plain:""},on:{click:function(i){return t.attention(!1)}}},[t._v("关注")])],1)]},proxy:!0}])}),a("van-divider"),a("div",{staticClass:"art-content",domProps:{innerHTML:t._s(t.articleDetailList.content)}}),a("van-divider",[t._v("End")]),a("div",{staticClass:"like-box"},[1===t.articleDetailList.attitude?a("van-button",{attrs:{icon:"good-job",type:"danger",size:"small"},on:{click:function(i){return t.loveFn(!0)}}},[t._v("已点赞")]):-1===t.articleDetailList.attitude?a("van-button",{attrs:{icon:"good-job-o",type:"danger",plain:"",size:"small"},on:{click:function(i){return t.loveFn(!1)}}},[t._v("点赞")]):t._e()],1)],1),a("comment")],1)],1)},n=[],o=a(5394),s=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",[a("div",{staticClass:"cmt-list",class:{"cmt-container-1":!t.isShowCommentInputVisible,"cmt-container-2":t.isShowCommentInputVisible}},[a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多评论辣，快去发表评论吧","immediate-check":!1},on:{load:t.onLoad},model:{value:t.loading,callback:function(i){t.loading=i},expression:"loading"}},t._l(t.commentList,(function(i){return a("div",{key:i.com_id,staticClass:"cmt-item"},[a("div",{staticClass:"cmt-header"},[a("div",{staticClass:"cmt-header-left"},[a("img",{staticClass:"avatar",attrs:{src:i.aut_photo,alt:""}}),a("span",{staticClass:"uname"},[t._v(t._s(i.aut_name))])]),a("div",{staticClass:"cmt-header-right"},[!0===i.is_liking?a("van-icon",{attrs:{name:"like",size:"16",color:"red"},on:{click:function(a){return t.likeComment(!0,i)}}}):a("van-icon",{attrs:{name:"like-o",size:"16",color:"gray"},on:{click:function(a){return t.likeComment(!1,i)}}})],1)]),a("div",{staticClass:"cmt-body"},[t._v(t._s(i.content))]),a("div",{staticClass:"cmt-footer"},[t._v(t._s(i.pubdate))])])})),0)],1),!1===t.isShowCommentInputVisible?a("div",{staticClass:"add-cmt-box van-hairline--top"},[a("van-icon",{attrs:{name:"arrow-left",size:"0.48rem"},on:{click:function(i){return t.$router.back()}}}),a("div",{staticClass:"ipt-cmt-div",on:{click:function(i){t.isShowCommentInputVisible=!0}}},[t._v("发表评论")]),a("div",{staticClass:"icon-box"},[a("van-badge",{attrs:{content:0===t.totalComment?"":t.totalComment,max:"99"}},[a("van-icon",{attrs:{name:"comment-o",size:"0.53333334rem"},on:{click:t.scrollToComment}})],1),a("span",[!1===t.isStar?a("van-icon",{attrs:{name:"star-o",size:"0.53333334rem"},on:{click:t.starFn}}):a("van-icon",{attrs:{name:"star",size:"0.53333334rem",color:"red"},on:{click:t.starFn}})],1),a("van-icon",{attrs:{name:"share-o",size:"0.53333334rem"},on:{click:t.showShareFn}})],1)],1):a("div",{staticClass:"cmt-box van-hairline--top"},[a("textarea",{directives:[{name:"fofo",rawName:"v-fofo"},{name:"model",rawName:"v-model.trim",value:t.commentContent,expression:"commentContent",modifiers:{trim:!0}}],attrs:{placeholder:"请发表一个友善的评论哟"},domProps:{value:t.commentContent},on:{blur:[t.blurFn,function(i){return t.$forceUpdate()}],input:function(i){i.target.composing||(t.commentContent=i.target.value.trim())}}}),a("van-button",{attrs:{type:"default",disabled:0===t.commentContent.length},on:{click:t.sendCommentFn}},[t._v("发布")])],1),a("van-share-sheet",{attrs:{title:"立即分享给好友",options:t.options},model:{value:t.showShare,callback:function(i){t.showShare=i},expression:"showShare"}})],1)},l=[],c={data(){return{commentList:[],lastId:null,isShowCommentInputVisible:!1,totalComment:0,commentContent:"",loading:!1,finished:!1,isStar:!1,showShare:!1,options:[[{name:"微信",icon:"wechat"},{name:"朋友圈",icon:"wechat-moments"},{name:"微博",icon:"weibo"},{name:"QQ",icon:"qq"}],[{name:"复制链接",icon:"link"},{name:"分享海报",icon:"poster"},{name:"二维码",icon:"qrcode"},{name:"小程序码",icon:"weapp-qrcode"}]]}},async created(){const t=await(0,o.x9)({art_id:this.$route.query.art_id});this.commentList=t.data.data.results,this.totalComment=t.data.data.total_count,this.lastId=t.data.data.last_id,0===this.totalComment&&(this.finished=!0)},methods:{async likeComment(t,i){!0===t?(i.is_liking=!1,await(0,o.PI)({com_id:i.com_id})):(i.is_liking=!0,await(0,o.Yf)({com_id:i.com_id}))},scrollToComment(){document.querySelector(".like-box").scrollIntoView({behavior:"smooth"})},async sendCommentFn(){const t=await(0,o.qQ)({id:this.$route.query.art_id,content:this.commentContent});this.commentList.unshift(t.data.data.new_obj),this.totalComment++,this.scrollToComment(),this.commentContent=""},blurFn(){setTimeout((()=>{this.isShowCommentInputVisible=!1}),0)},async onLoad(){if(this.commentList.length>0){const t=await(0,o.x9)({art_id:this.$route.query.art_id,offset:this.lastId});console.log(t),this.commentList=[...this.commentList,...t.data.data.results],this.totalComment=t.data.data.total_count,this.lastId=t.data.data.last_id,null===this.lastId&&(this.finished=!0),this.loading=!1}else this.loading=!1},showShareFn(){this.showShare=!0},async starFn(){this.isStar=!this.isStar;const t=await(0,o.Yq)({art_id:this.$route.query.art_id});console.log(t)}}},r=c,m=a(1001),d=(0,m.Z)(r,s,l,!1,null,"ef122136",null),u=d.exports,h={name:"ArticleDetail",data(){return{articleDetailList:{}}},async created(){const t=await(0,o.Qv)({article_id:this.$route.query.art_id});this.articleDetailList=t.data.data},methods:{async attention(t){!0===t?(this.articleDetailList.is_followed=!1,await(0,o.TO)({aut_id:this.articleDetailList.aut_id})):(this.articleDetailList.is_followed=!0,await(0,o.ph)({aut_id:this.articleDetailList.aut_id}))},async loveFn(t){if(!0===t){this.articleDetailList.attitude=-1;const t=await(0,o.Id)({art_id:this.$route.query.art_id});console.log(t)}else{this.articleDetailList.attitude=1;const t=await(0,o.Te)({art_id:this.$route.query.art_id});console.log(t)}}},components:{Comment:u}},v=h,f=(0,m.Z)(v,e,n,!1,null,"94444fba",null),_=f.exports}}]);
//# sourceMappingURL=546.78edcb93.js.map